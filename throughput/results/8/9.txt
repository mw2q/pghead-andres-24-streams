BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267225238.512876
 ALGERIA                   |   1997 | 455038323.987088
 ALGERIA                   |   1996 | 452457647.537052
 ALGERIA                   |   1995 | 459240071.747162
 ALGERIA                   |   1994 | 450758278.927331
 ALGERIA                   |   1993 | 456404019.623382
 ALGERIA                   |   1992 | 457346192.329445
 ARGENTINA                 |   1998 | 272343655.572991
 ARGENTINA                 |   1997 | 473602464.086281
 ARGENTINA                 |   1996 | 469551763.204587
 ARGENTINA                 |   1995 | 467007647.044545
 ARGENTINA                 |   1994 | 474996900.136808
 ARGENTINA                 |   1993 | 467471336.847305
 ARGENTINA                 |   1992 | 474545255.128168
 BRAZIL                    |   1998 | 274860684.988703
 BRAZIL                    |   1997 | 467205073.829737
 BRAZIL                    |   1996 | 466914971.022838
 BRAZIL                    |   1995 | 465738835.571073
 BRAZIL                    |   1994 | 469090346.548528
 BRAZIL                    |   1993 | 464657494.125934
 BRAZIL                    |   1992 | 476795515.077097
 CANADA                    |   1998 | 280688949.670706
 CANADA                    |   1997 | 481441531.310464
 CANADA                    |   1996 | 477414942.230396
 CANADA                    |   1995 | 475330093.892545
 CANADA                    |   1994 | 485239722.582856
 CANADA                    |   1993 |  479743573.77335
 CANADA                    |   1992 | 476496134.569288
 CHINA                     |   1998 | 274070575.537997
 CHINA                     |   1997 | 468198380.865787
 CHINA                     |   1996 | 471621996.546805
 CHINA                     |   1995 | 456261681.921354
 CHINA                     |   1994 | 468447445.503127
 CHINA                     |   1993 | 474498909.531847
 CHINA                     |   1992 | 468992142.827386
 EGYPT                     |   1998 | 276220890.585282
 EGYPT                     |   1997 | 461780207.584351
 EGYPT                     |   1996 | 466377262.003483
 EGYPT                     |   1995 | 462362244.804223
 EGYPT                     |   1994 | 463873869.611463
 EGYPT                     |   1993 | 458869639.547472
 EGYPT                     |   1992 | 462401485.780022
 ETHIOPIA                  |   1998 |  263789729.67927
 ETHIOPIA                  |   1997 | 450173994.915928
 ETHIOPIA                  |   1996 | 452477250.200686
 ETHIOPIA                  |   1995 | 454033655.837955
 ETHIOPIA                  |   1994 | 459278600.636987
 ETHIOPIA                  |   1993 | 453787112.791128
 ETHIOPIA                  |   1992 | 452401759.328348
 FRANCE                    |   1998 | 268960825.137523
 FRANCE                    |   1997 |  453750203.08161
 FRANCE                    |   1996 | 459529472.951396
 FRANCE                    |   1995 | 465604295.454533
 FRANCE                    |   1994 | 453294478.325353
 FRANCE                    |   1993 | 459555974.078851
 FRANCE                    |   1992 | 458904075.932687
 GERMANY                   |   1998 | 277925726.701355
 GERMANY                   |   1997 | 473199529.416597
 GERMANY                   |   1996 | 472223308.424776
 GERMANY                   |   1995 | 468352704.953908
 GERMANY                   |   1994 | 471322110.176977
 GERMANY                   |   1993 | 472655933.631905
 GERMANY                   |   1992 | 467181667.530066
 INDIA                     |   1998 | 270559285.733653
 INDIA                     |   1997 | 468389447.031927
 INDIA                     |   1996 |  466391086.77094
 INDIA                     |   1995 | 464290014.522339
 INDIA                     |   1994 | 469214057.809473
 INDIA                     |   1993 | 464057950.459002
 INDIA                     |   1992 | 470336592.594881
 INDONESIA                 |   1998 | 268204410.761318
 INDONESIA                 |   1997 | 462391462.963912
 INDONESIA                 |   1996 | 458217555.155965
 INDONESIA                 |   1995 | 457281647.942497
 INDONESIA                 |   1994 | 463031219.949508
 INDONESIA                 |   1993 | 458377044.116005
 INDONESIA                 |   1992 | 458829046.235411
 IRAN                      |   1998 | 268076276.183052
 IRAN                      |   1997 | 446565846.104259
 IRAN                      |   1996 | 459987589.056525
 IRAN                      |   1995 | 454308026.430322
 IRAN                      |   1994 | 459038510.910192
 IRAN                      |   1993 | 453555518.395952
 IRAN                      |   1992 | 454981937.036049
 IRAQ                      |   1998 | 276920214.034401
 IRAQ                      |   1997 | 469816037.705762
 IRAQ                      |   1996 | 472933515.182231
 IRAQ                      |   1995 | 471323133.441609
 IRAQ                      |   1994 | 468176513.798145
 IRAQ                      |   1993 | 468875726.617889
 IRAQ                      |   1992 | 464583228.566177
 JAPAN                     |   1998 | 271312698.383932
 JAPAN                     |   1997 | 465953542.434421
 JAPAN                     |   1996 | 460061636.611421
 JAPAN                     |   1995 | 463523751.934256
 JAPAN                     |   1994 | 469403650.420346
 JAPAN                     |   1993 | 473252143.601051
 JAPAN                     |   1992 | 465165849.741321
 JORDAN                    |   1998 | 271035602.212238
 JORDAN                    |   1997 | 464775498.375334
 JORDAN                    |   1996 | 455560124.519029
 JORDAN                    |   1995 | 458344148.256266
 JORDAN                    |   1994 | 458999786.169256
 JORDAN                    |   1993 | 461176280.751484
 JORDAN                    |   1992 | 463127891.768435
 KENYA                     |   1998 | 272097104.080959
 KENYA                     |   1997 | 460075597.144565
 KENYA                     |   1996 | 467372017.494958
 KENYA                     |   1995 | 458363634.261925
 KENYA                     |   1994 | 459738126.216255
 KENYA                     |   1993 | 465384314.404799
 KENYA                     |   1992 | 463909525.863287
 MOROCCO                   |   1998 | 272500913.902882
 MOROCCO                   |   1997 | 466377862.928917
 MOROCCO                   |   1996 | 471919801.444688
 MOROCCO                   |   1995 | 469369281.105313
 MOROCCO                   |   1994 | 463433245.304536
 MOROCCO                   |   1993 | 468574543.720501
 MOROCCO                   |   1992 | 470788582.880306
 MOZAMBIQUE                |   1998 | 273276126.071992
 MOZAMBIQUE                |   1997 | 455091058.483465
 MOZAMBIQUE                |   1996 | 464266724.766605
 MOZAMBIQUE                |   1995 | 459810087.336481
 MOZAMBIQUE                |   1994 | 457846185.236598
 MOZAMBIQUE                |   1993 | 453406224.510954
 MOZAMBIQUE                |   1992 | 460713053.204278
 PERU                      |   1998 | 268291296.563487
 PERU                      |   1997 |  473968673.90083
 PERU                      |   1996 | 469342524.589249
 PERU                      |   1995 | 457378035.225237
 PERU                      |   1994 | 467061138.595155
 PERU                      |   1993 | 466371274.705416
 PERU                      |   1992 | 475654427.970979
 ROMANIA                   |   1998 | 271704800.954414
 ROMANIA                   |   1997 | 458643840.868231
 ROMANIA                   |   1996 | 465986135.791905
 ROMANIA                   |   1995 | 461592819.146277
 ROMANIA                   |   1994 | 456725799.061621
 ROMANIA                   |   1993 | 456910444.107913
 ROMANIA                   |   1992 | 460162615.632947
 RUSSIA                    |   1998 | 280474234.868077
 RUSSIA                    |   1997 | 467304905.713941
 RUSSIA                    |   1996 | 479731819.015212
 RUSSIA                    |   1995 | 470862926.673886
 RUSSIA                    |   1994 | 470879859.345641
 RUSSIA                    |   1993 | 466170668.489941
 RUSSIA                    |   1992 | 464330658.237979
 SAUDI ARABIA              |   1998 | 278970089.740742
 SAUDI ARABIA              |   1997 | 464617937.747628
 SAUDI ARABIA              |   1996 | 476453862.577516
 SAUDI ARABIA              |   1995 | 464782604.297287
 SAUDI ARABIA              |   1994 | 465551168.757448
 SAUDI ARABIA              |   1993 | 468284962.147522
 SAUDI ARABIA              |   1992 |  472135859.08577
 UNITED KINGDOM            |   1998 | 270940612.115885
 UNITED KINGDOM            |   1997 | 455423044.760802
 UNITED KINGDOM            |   1996 | 453670009.398494
 UNITED KINGDOM            |   1995 | 453608375.486405
 UNITED KINGDOM            |   1994 | 460204344.217737
 UNITED KINGDOM            |   1993 | 457488096.665405
 UNITED KINGDOM            |   1992 | 450587131.120022
 UNITED STATES             |   1998 | 274625565.334333
 UNITED STATES             |   1997 | 468811775.618204
 UNITED STATES             |   1996 | 462301669.037051
 UNITED STATES             |   1995 | 464640239.319159
 UNITED STATES             |   1994 | 472117717.474412
 UNITED STATES             |   1993 | 462733333.748732
 UNITED STATES             |   1992 |  466616765.48545
 VIETNAM                   |   1998 | 270881541.540754
 VIETNAM                   |   1997 | 457274876.438067
 VIETNAM                   |   1996 | 465250810.085463
 VIETNAM                   |   1995 | 462188109.710897
 VIETNAM                   |   1994 | 468299614.623642
 VIETNAM                   |   1993 | 466568115.493322
 VIETNAM                   |   1992 | 462931283.127078
(175 rows)

COMMIT;
COMMIT
