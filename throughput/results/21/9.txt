BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burlywood%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 265219827.073397
 ALGERIA                   |   1997 | 456724836.780004
 ALGERIA                   |   1996 | 454661688.340263
 ALGERIA                   |   1995 | 463437605.919345
 ALGERIA                   |   1994 |  453035862.49828
 ALGERIA                   |   1993 | 458843775.581565
 ALGERIA                   |   1992 | 455654633.552004
 ARGENTINA                 |   1998 | 268917728.618412
 ARGENTINA                 |   1997 | 464969135.528449
 ARGENTINA                 |   1996 | 462399511.048455
 ARGENTINA                 |   1995 | 469574155.480402
 ARGENTINA                 |   1994 | 464575856.285513
 ARGENTINA                 |   1993 | 468789383.287054
 ARGENTINA                 |   1992 | 457921631.537352
 BRAZIL                    |   1998 | 278040991.205856
 BRAZIL                    |   1997 | 470246739.501494
 BRAZIL                    |   1996 | 469236129.494225
 BRAZIL                    |   1995 | 474374926.299155
 BRAZIL                    |   1994 | 461374820.175394
 BRAZIL                    |   1993 | 471694844.843344
 BRAZIL                    |   1992 | 471308328.706425
 CANADA                    |   1998 | 276361271.273977
 CANADA                    |   1997 | 474613569.754832
 CANADA                    |   1996 | 475934964.682296
 CANADA                    |   1995 | 482579643.553317
 CANADA                    |   1994 | 482978580.481598
 CANADA                    |   1993 |  473456832.62706
 CANADA                    |   1992 | 469674339.153531
 CHINA                     |   1998 | 270607179.789225
 CHINA                     |   1997 | 461828543.900766
 CHINA                     |   1996 | 469915415.638066
 CHINA                     |   1995 | 460233472.067492
 CHINA                     |   1994 | 465479221.809213
 CHINA                     |   1993 | 457523110.996555
 CHINA                     |   1992 | 459006075.516322
 EGYPT                     |   1998 | 265563225.680126
 EGYPT                     |   1997 | 465893193.844818
 EGYPT                     |   1996 | 462372510.172516
 EGYPT                     |   1995 | 451744630.612384
 EGYPT                     |   1994 | 460186556.737129
 EGYPT                     |   1993 | 457024561.901511
 EGYPT                     |   1992 | 460643178.529089
 ETHIOPIA                  |   1998 | 263753839.412098
 ETHIOPIA                  |   1997 | 454739519.811106
 ETHIOPIA                  |   1996 | 460407186.234094
 ETHIOPIA                  |   1995 | 459327411.065522
 ETHIOPIA                  |   1994 | 459112867.500545
 ETHIOPIA                  |   1993 | 463561662.065446
 ETHIOPIA                  |   1992 | 459523822.015708
 FRANCE                    |   1998 | 264298669.919389
 FRANCE                    |   1997 | 454480448.463916
 FRANCE                    |   1996 | 466579053.409497
 FRANCE                    |   1995 | 462850785.768659
 FRANCE                    |   1994 | 455055154.983752
 FRANCE                    |   1993 | 459134182.362036
 FRANCE                    |   1992 | 471152138.635921
 GERMANY                   |   1998 | 282205583.529477
 GERMANY                   |   1997 | 480577657.240069
 GERMANY                   |   1996 | 475370356.912052
 GERMANY                   |   1995 | 469190998.344788
 GERMANY                   |   1994 | 473348248.040416
 GERMANY                   |   1993 | 480528697.491291
 GERMANY                   |   1992 | 479061090.963687
 INDIA                     |   1998 | 277967242.962429
 INDIA                     |   1997 | 472794577.499642
 INDIA                     |   1996 | 479283562.652095
 INDIA                     |   1995 | 470835607.244963
 INDIA                     |   1994 | 477939866.055044
 INDIA                     |   1993 | 476165883.611853
 INDIA                     |   1992 | 471549191.423498
 INDONESIA                 |   1998 | 277170635.891545
 INDONESIA                 |   1997 | 462048643.087451
 INDONESIA                 |   1996 | 464179532.310329
 INDONESIA                 |   1995 | 465735717.556509
 INDONESIA                 |   1994 | 467289680.733342
 INDONESIA                 |   1993 | 461010167.202612
 INDONESIA                 |   1992 | 461374664.690664
 IRAN                      |   1998 | 270913544.441861
 IRAN                      |   1997 |  455550765.31388
 IRAN                      |   1996 | 448220137.208054
 IRAN                      |   1995 | 463431859.211287
 IRAN                      |   1994 | 455577246.201646
 IRAN                      |   1993 | 451081952.816887
 IRAN                      |   1992 | 461054883.172349
 IRAQ                      |   1998 |  275065755.31487
 IRAQ                      |   1997 | 472506495.010206
 IRAQ                      |   1996 | 470110399.664313
 IRAQ                      |   1995 | 473039979.191274
 IRAQ                      |   1994 | 474160312.890121
 IRAQ                      |   1993 | 471426990.588742
 IRAQ                      |   1992 | 471260847.345003
 JAPAN                     |   1998 | 274611587.088877
 JAPAN                     |   1997 | 466444868.762556
 JAPAN                     |   1996 | 471471748.204949
 JAPAN                     |   1995 | 463367893.808551
 JAPAN                     |   1994 | 473758805.489889
 JAPAN                     |   1993 | 469631809.013975
 JAPAN                     |   1992 | 462201798.943407
 JORDAN                    |   1998 | 270691125.550028
 JORDAN                    |   1997 | 460764824.698249
 JORDAN                    |   1996 | 457399936.483494
 JORDAN                    |   1995 |  461708534.46565
 JORDAN                    |   1994 | 458084029.750547
 JORDAN                    |   1993 | 467563770.719185
 JORDAN                    |   1992 | 461416613.466005
 KENYA                     |   1998 | 272744955.308164
 KENYA                     |   1997 | 470053352.342121
 KENYA                     |   1996 | 469351454.670885
 KENYA                     |   1995 | 471027134.627999
 KENYA                     |   1994 | 473038272.546423
 KENYA                     |   1993 | 470797575.235657
 KENYA                     |   1992 |  472721824.85042
 MOROCCO                   |   1998 | 279025840.505234
 MOROCCO                   |   1997 | 474998685.766836
 MOROCCO                   |   1996 | 477634372.506155
 MOROCCO                   |   1995 | 469742003.342704
 MOROCCO                   |   1994 |  473732156.44644
 MOROCCO                   |   1993 | 472473844.779193
 MOROCCO                   |   1992 | 476654536.598184
 MOZAMBIQUE                |   1998 | 276017603.993432
 MOZAMBIQUE                |   1997 | 464606911.629698
 MOZAMBIQUE                |   1996 | 458526438.465898
 MOZAMBIQUE                |   1995 | 463870868.249926
 MOZAMBIQUE                |   1994 | 456151438.000231
 MOZAMBIQUE                |   1993 | 456237096.256302
 MOZAMBIQUE                |   1992 | 462481795.574069
 PERU                      |   1998 | 264797250.633682
 PERU                      |   1997 | 461680792.957235
 PERU                      |   1996 | 463955015.115259
 PERU                      |   1995 | 455828674.569477
 PERU                      |   1994 |  456183412.71409
 PERU                      |   1993 | 449536062.105594
 PERU                      |   1992 | 452463106.473513
 ROMANIA                   |   1998 | 271339326.559588
 ROMANIA                   |   1997 | 463240395.465001
 ROMANIA                   |   1996 | 464664758.525868
 ROMANIA                   |   1995 |  464821801.74107
 ROMANIA                   |   1994 |  469604140.91884
 ROMANIA                   |   1993 | 464198589.117888
 ROMANIA                   |   1992 | 471720916.016338
 RUSSIA                    |   1998 | 274378145.251185
 RUSSIA                    |   1997 | 467055173.560166
 RUSSIA                    |   1996 |  464616011.85532
 RUSSIA                    |   1995 | 469963476.801799
 RUSSIA                    |   1994 | 464239055.373968
 RUSSIA                    |   1993 | 465677675.720097
 RUSSIA                    |   1992 | 469379327.209167
 SAUDI ARABIA              |   1998 | 277398635.300238
 SAUDI ARABIA              |   1997 | 462109446.318022
 SAUDI ARABIA              |   1996 | 461784688.274092
 SAUDI ARABIA              |   1995 |  465266889.26889
 SAUDI ARABIA              |   1994 | 463190633.836254
 SAUDI ARABIA              |   1993 | 462347775.515252
 SAUDI ARABIA              |   1992 | 462359543.110759
 UNITED KINGDOM            |   1998 | 266168663.459849
 UNITED KINGDOM            |   1997 | 456835092.047979
 UNITED KINGDOM            |   1996 | 454651048.940892
 UNITED KINGDOM            |   1995 | 457010865.052597
 UNITED KINGDOM            |   1994 | 449770296.375976
 UNITED KINGDOM            |   1993 |  452207026.11523
 UNITED KINGDOM            |   1992 | 455036212.511257
 UNITED STATES             |   1998 | 279119734.329338
 UNITED STATES             |   1997 | 473036503.341904
 UNITED STATES             |   1996 | 474698031.932281
 UNITED STATES             |   1995 | 474395822.758828
 UNITED STATES             |   1994 | 480515580.455477
 UNITED STATES             |   1993 | 475931906.845811
 UNITED STATES             |   1992 | 475039167.671525
 VIETNAM                   |   1998 | 275252235.834409
 VIETNAM                   |   1997 | 461147368.131274
 VIETNAM                   |   1996 | 471093628.690286
 VIETNAM                   |   1995 | 460363123.891046
 VIETNAM                   |   1994 | 465956033.184528
 VIETNAM                   |   1993 | 466196760.526302
 VIETNAM                   |   1992 | 469211731.210203
(175 rows)

COMMIT;
COMMIT
