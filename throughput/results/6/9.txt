BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270796134.049702
 ALGERIA                   |   1997 |  458770085.28131
 ALGERIA                   |   1996 | 465587108.554121
 ALGERIA                   |   1995 | 465651475.869799
 ALGERIA                   |   1994 | 459104682.072447
 ALGERIA                   |   1993 | 460102514.169701
 ALGERIA                   |   1992 | 463378708.160445
 ARGENTINA                 |   1998 | 272153245.423243
 ARGENTINA                 |   1997 | 468489015.634755
 ARGENTINA                 |   1996 | 467315644.466053
 ARGENTINA                 |   1995 | 470940867.474726
 ARGENTINA                 |   1994 | 462263309.964763
 ARGENTINA                 |   1993 | 466290885.017083
 ARGENTINA                 |   1992 | 464651138.347136
 BRAZIL                    |   1998 | 271752377.992359
 BRAZIL                    |   1997 |  459970542.58531
 BRAZIL                    |   1996 | 468643559.067302
 BRAZIL                    |   1995 | 469514882.231166
 BRAZIL                    |   1994 |  468290755.86772
 BRAZIL                    |   1993 | 462244607.960523
 BRAZIL                    |   1992 | 474663864.015672
 CANADA                    |   1998 |  280572567.92628
 CANADA                    |   1997 | 478675201.411974
 CANADA                    |   1996 | 472800414.179415
 CANADA                    |   1995 | 479419789.444373
 CANADA                    |   1994 |  487463237.98605
 CANADA                    |   1993 | 476587741.383841
 CANADA                    |   1992 | 472487980.067086
 CHINA                     |   1998 |  270614903.18325
 CHINA                     |   1997 | 454226754.672462
 CHINA                     |   1996 | 470938049.223524
 CHINA                     |   1995 | 468808754.648387
 CHINA                     |   1994 | 464185685.571592
 CHINA                     |   1993 | 466174234.685537
 CHINA                     |   1992 | 471120852.487559
 EGYPT                     |   1998 | 271002077.570633
 EGYPT                     |   1997 | 469163362.596251
 EGYPT                     |   1996 |  472245210.26618
 EGYPT                     |   1995 | 462732494.051706
 EGYPT                     |   1994 | 456091991.124135
 EGYPT                     |   1993 | 465893578.435605
 EGYPT                     |   1992 | 468444297.063809
 ETHIOPIA                  |   1998 | 264277043.939766
 ETHIOPIA                  |   1997 | 453021514.058109
 ETHIOPIA                  |   1996 | 449523836.344609
 ETHIOPIA                  |   1995 | 453778472.318781
 ETHIOPIA                  |   1994 | 454877491.885203
 ETHIOPIA                  |   1993 | 457980864.257563
 ETHIOPIA                  |   1992 | 457583823.587775
 FRANCE                    |   1998 | 273596765.127044
 FRANCE                    |   1997 | 463982000.294436
 FRANCE                    |   1996 | 464928084.554192
 FRANCE                    |   1995 | 458176586.015336
 FRANCE                    |   1994 | 459417197.949736
 FRANCE                    |   1993 | 461355531.806932
 FRANCE                    |   1992 | 460795945.141367
 GERMANY                   |   1998 | 279029468.607303
 GERMANY                   |   1997 | 476846446.305681
 GERMANY                   |   1996 | 475129650.305461
 GERMANY                   |   1995 | 463961936.773966
 GERMANY                   |   1994 | 480913290.320401
 GERMANY                   |   1993 | 473744681.001692
 GERMANY                   |   1992 | 478976308.332526
 INDIA                     |   1998 | 276000339.425911
 INDIA                     |   1997 |  464664227.66425
 INDIA                     |   1996 | 470621921.690684
 INDIA                     |   1995 | 475357639.473203
 INDIA                     |   1994 | 468231941.875429
 INDIA                     |   1993 | 468089150.953918
 INDIA                     |   1992 | 476427000.071596
 INDONESIA                 |   1998 | 275611902.069979
 INDONESIA                 |   1997 | 460777750.262483
 INDONESIA                 |   1996 | 465113643.924149
 INDONESIA                 |   1995 | 467646377.082769
 INDONESIA                 |   1994 |  463304294.19522
 INDONESIA                 |   1993 | 467278739.728127
 INDONESIA                 |   1992 |  457844622.73642
 IRAN                      |   1998 | 271792486.240901
 IRAN                      |   1997 |  464153641.18477
 IRAN                      |   1996 | 469985181.584142
 IRAN                      |   1995 | 469704987.842858
 IRAN                      |   1994 | 466304878.743495
 IRAN                      |   1993 | 462627624.523792
 IRAN                      |   1992 | 464262905.322495
 IRAQ                      |   1998 | 275240057.378006
 IRAQ                      |   1997 | 470856875.567905
 IRAQ                      |   1996 | 476640664.320489
 IRAQ                      |   1995 | 470931713.067012
 IRAQ                      |   1994 | 473457793.735148
 IRAQ                      |   1993 | 475130646.697175
 IRAQ                      |   1992 | 473580103.066258
 JAPAN                     |   1998 | 273357193.036334
 JAPAN                     |   1997 | 463683069.650228
 JAPAN                     |   1996 | 462743758.773565
 JAPAN                     |   1995 | 457059758.967924
 JAPAN                     |   1994 | 451163533.002426
 JAPAN                     |   1993 | 462030995.307225
 JAPAN                     |   1992 | 462216995.650539
 JORDAN                    |   1998 |  272633417.97805
 JORDAN                    |   1997 | 467860232.210524
 JORDAN                    |   1996 |  459281932.67218
 JORDAN                    |   1995 | 453105971.306523
 JORDAN                    |   1994 | 461557574.081477
 JORDAN                    |   1993 | 464419110.581666
 JORDAN                    |   1992 | 462725302.139025
 KENYA                     |   1998 | 270623228.255277
 KENYA                     |   1997 | 467065640.569348
 KENYA                     |   1996 | 471400825.237934
 KENYA                     |   1995 | 470490011.047006
 KENYA                     |   1994 |  472703844.44608
 KENYA                     |   1993 | 468628161.903125
 KENYA                     |   1992 | 473951311.855914
 MOROCCO                   |   1998 | 266003808.437326
 MOROCCO                   |   1997 | 468348367.950364
 MOROCCO                   |   1996 | 465781283.030694
 MOROCCO                   |   1995 | 461771106.112186
 MOROCCO                   |   1994 | 459575880.242232
 MOROCCO                   |   1993 | 465520387.635963
 MOROCCO                   |   1992 |  464080065.49396
 MOZAMBIQUE                |   1998 | 270560601.867655
 MOZAMBIQUE                |   1997 | 453313514.016264
 MOZAMBIQUE                |   1996 | 454168895.809259
 MOZAMBIQUE                |   1995 | 458230977.322467
 MOZAMBIQUE                |   1994 | 461552496.333809
 MOZAMBIQUE                |   1993 | 458627105.908883
 MOZAMBIQUE                |   1992 | 460864383.655618
 PERU                      |   1998 |  268720649.91772
 PERU                      |   1997 | 469174851.113298
 PERU                      |   1996 | 471199736.596308
 PERU                      |   1995 | 466838889.109563
 PERU                      |   1994 | 459295376.698737
 PERU                      |   1993 | 469496723.221903
 PERU                      |   1992 | 460956913.175378
 ROMANIA                   |   1998 |  275495074.40796
 ROMANIA                   |   1997 | 464105651.209739
 ROMANIA                   |   1996 |  471337637.48522
 ROMANIA                   |   1995 | 466823953.419756
 ROMANIA                   |   1994 | 465302820.232762
 ROMANIA                   |   1993 | 472883070.696781
 ROMANIA                   |   1992 | 471122166.813164
 RUSSIA                    |   1998 | 270354978.052308
 RUSSIA                    |   1997 | 464595213.788666
 RUSSIA                    |   1996 | 474892793.152534
 RUSSIA                    |   1995 | 466473848.357602
 RUSSIA                    |   1994 | 462550837.108368
 RUSSIA                    |   1993 | 468475510.029221
 RUSSIA                    |   1992 | 463912142.226958
 SAUDI ARABIA              |   1998 | 278384832.182537
 SAUDI ARABIA              |   1997 | 475254869.667336
 SAUDI ARABIA              |   1996 |  463015334.08125
 SAUDI ARABIA              |   1995 | 468485861.317186
 SAUDI ARABIA              |   1994 |  471387716.58903
 SAUDI ARABIA              |   1993 | 460567197.964348
 SAUDI ARABIA              |   1992 | 467347768.321172
 UNITED KINGDOM            |   1998 | 263282052.927019
 UNITED KINGDOM            |   1997 | 449223321.919591
 UNITED KINGDOM            |   1996 | 452977766.423933
 UNITED KINGDOM            |   1995 | 458244761.967973
 UNITED KINGDOM            |   1994 | 464809032.497341
 UNITED KINGDOM            |   1993 | 451884173.800634
 UNITED KINGDOM            |   1992 | 453175524.702222
 UNITED STATES             |   1998 | 266331090.973032
 UNITED STATES             |   1997 | 466345239.050651
 UNITED STATES             |   1996 | 462029626.458812
 UNITED STATES             |   1995 | 462525250.968768
 UNITED STATES             |   1994 |  463287279.78945
 UNITED STATES             |   1993 | 460286831.627816
 UNITED STATES             |   1992 | 460394963.946333
 VIETNAM                   |   1998 | 272688923.736891
 VIETNAM                   |   1997 |  462305750.37572
 VIETNAM                   |   1996 | 465748381.322113
 VIETNAM                   |   1995 | 467542576.868469
 VIETNAM                   |   1994 | 475109248.212358
 VIETNAM                   |   1993 | 465686154.578762
 VIETNAM                   |   1992 | 461286449.144391
(175 rows)

COMMIT;
COMMIT
